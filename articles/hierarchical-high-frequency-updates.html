<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Hierarchical High-Frequency Updates | ProDataGrid for Avalonia </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Hierarchical High-Frequency Updates | ProDataGrid for Avalonia ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/wieslawsoltes/ProDataGrid/blob/master/docfx/articles/hierarchical-high-frequency-updates.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="hierarchical-high-frequency-updates">Hierarchical High-Frequency Updates</h1>

<p>HierarchicalModel maintains a flattened list of visible nodes. When child collections report incremental changes with indices, the model can update the flattened view in constant time instead of rebuilding entire subtrees.</p>
<h2 id="fast-path-requirements">Fast-path requirements</h2>
<p>Each expanded node stays on the fast path when:</p>
<ul>
<li>Children collections implement <code>IList</code> and <code>INotifyCollectionChanged</code>.</li>
<li>Change notifications include indices:
<ul>
<li><code>Add</code> uses <code>NewStartingIndex</code>.</li>
<li><code>Remove</code>/<code>Replace</code> use <code>OldStartingIndex</code>.</li>
<li><code>Move</code> supplies both old and new indices.</li>
</ul>
</li>
<li>No per-parent sorting is applied (<code>SiblingComparer</code>/<code>SiblingComparerSelector</code> are null).</li>
<li>Collections avoid <code>Reset</code> in favor of incremental add/remove/move/replace.</li>
</ul>
<h2 id="update-patterns-that-stay-fast">Update patterns that stay fast</h2>
<p>Batch updates with <code>ObservableRangeCollection&lt;T&gt;</code> to avoid per-item churn:</p>
<pre><code class="lang-csharp">var roots = new ObservableRangeCollection&lt;TreeItem&gt;();

var options = new HierarchicalOptions&lt;TreeItem&gt;
{
    ChildrenSelector = item =&gt; item.Children,
    IsExpandedSelector = item =&gt; item.IsExpanded,
    IsExpandedSetter = (item, value) =&gt; item.IsExpanded = value
};

var model = new HierarchicalModel&lt;TreeItem&gt;(options);
model.SetRoots(roots);

roots.AddRange(CreateBatch());
roots.RemoveRange(0, 25);
</code></pre>
<h2 id="expanded-vs-collapsed-nodes">Expanded vs collapsed nodes</h2>
<p>When a parent node is collapsed, the model updates its expanded counts but does not touch the flattened list until the node becomes visible. This keeps hidden updates cheap while preserving correct counts for future expansion.</p>
<h2 id="when-the-model-refreshes">When the model refreshes</h2>
<p>The model falls back to a refresh when:</p>
<ul>
<li>A child collection raises <code>Reset</code>.</li>
<li>The change notification lacks indices.</li>
<li>A <code>SiblingComparer</code> or <code>SiblingComparerSelector</code> is active.</li>
<li>The children source is not list-like or does not notify changes.</li>
</ul>
<h2 id="sample">Sample</h2>
<p>See the <strong>Hierarchical Streaming Updates</strong> tab in the sample gallery for a full implementation.</p>
<h2 id="related-topics">Related topics</h2>
<ul>
<li><a href="observable-range-collection.html">ObservableRangeCollection and Performance</a></li>
<li><a href="hierarchical-data.html">Hierarchical Data</a></li>
<li><a href="high-frequency-updates.html">High-Frequency Updates</a></li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/wieslawsoltes/ProDataGrid/blob/master/docfx/articles/hierarchical-high-frequency-updates.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
