<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:viewModels="clr-namespace:DataGridSample.ViewModels"
             xmlns:DataGridDragDrop="clr-namespace:Avalonia.Controls.DataGridDragDrop;assembly=Avalonia.Controls.DataGrid"
             xmlns:hier="clr-namespace:Avalonia.Controls.DataGridHierarchical;assembly=Avalonia.Controls.DataGrid"
             x:Class="DataGridSample.Pages.HierarchicalRowDragDropPage"
             x:DataType="viewModels:HierarchicalRowDragDropViewModel">
  <UserControl.DataContext>
    <viewModels:HierarchicalRowDragDropViewModel />
  </UserControl.DataContext>

  <Grid RowDefinitions="Auto,Auto,Auto,*" RowSpacing="10">
    <TextBlock Grid.Row="0"
               Classes="h2"
               Text="Hierarchical row drag &amp; drop" />
    <TextBlock Grid.Row="1"
               TextWrapping="Wrap"
               Text="Reorder nodes across the hierarchy. Drags are limited to move operations and respect the current parent/child structure." />

    <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="8">
      <CheckBox Content="Show drag handle"
                IsChecked="{Binding ShowHandle}" />
      <StackPanel Orientation="Horizontal" Spacing="4">
        <TextBlock VerticalAlignment="Center" Text="Drag handle:" />
        <ComboBox Width="180"
                  SelectedItem="{Binding RowDragHandle}"
                  ItemsSource="{Binding DragHandles}">
          <ComboBox.ItemTemplate>
            <DataTemplate x:DataType="DataGridDragDrop:DataGridRowDragHandle">
              <TextBlock Text="{Binding .}" />
            </DataTemplate>
          </ComboBox.ItemTemplate>
        </ComboBox>
      </StackPanel>
      <Button Content="Expand all"
              Command="{Binding ExpandAllCommand}" />
      <Button Content="Collapse all"
              Command="{Binding CollapseAllCommand}" />
    </StackPanel>

    <DataGrid Grid.Row="3"
              CanUserReorderRows="True"
              HierarchicalRowsEnabled="True"
              RowDragHandle="{Binding RowDragHandle}"
              RowDragHandleVisible="{Binding ShowHandle}"
              RowDragDropOptions="{Binding Options}"
              RowDropHandler="{Binding DropHandler}"
              x:DataType="viewModels:HierarchicalRowDragDropViewModel"
              AutoGenerateColumns="False"
              HierarchicalModel="{Binding Model}"
              HeadersVisibility="All"
              RowHeaderWidth="28"
              GridLinesVisibility="Horizontal"
              SelectionMode="Extended">
      <DataGrid.Columns>
        <DataGridHierarchicalColumn Header="Name"
                                    Width="3*"
                                    x:CompileBindings="False"
                                    Binding="{Binding Item}">
          <DataGridHierarchicalColumn.CellTemplate>
            <DataTemplate x:DataType="viewModels:HierarchicalRowDragDropViewModel+TreeItem">
              <TextBlock Text="{Binding Name}" />
            </DataTemplate>
          </DataGridHierarchicalColumn.CellTemplate>
        </DataGridHierarchicalColumn>
        <DataGridTemplateColumn Header="Children"
                                Width="120">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate x:DataType="hier:HierarchicalNode">
              <TextBlock Text="{Binding Children.Count}" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
      </DataGrid.Columns>
    </DataGrid>
  </Grid>
</UserControl>
